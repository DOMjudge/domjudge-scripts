- name: setup admin machines
  hosts: admin
  vars:
    host_type: admin
  become: yes
  tasks:
    - name: include global variables
      include_vars: variables.yml

    - include: common_tasks_all.yml

    - name: install common required/useful packages
      tags: packages
      apt: pkg={{item}} state=present
      with_items:
        - htop
        - clusterssh

    - name: create working copy from the repo
      become: yes
      become_user: domjudge
      # We use a different directory here to have one single 'upstream' and not have issues with it
      git: repo={{DJ_GIT_REPO}} dest=/home/domjudge/domjudge-checkout version={{DJ_BRANCH}} accept_hostkey=yes update=yes
      register: git_working_copy
